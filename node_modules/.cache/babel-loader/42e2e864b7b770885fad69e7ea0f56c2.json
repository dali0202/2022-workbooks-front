{"ast":null,"code":"var _jsxFileName = \"/Users/keunhyung/IdeaProjects/workbooksfrontdev/front/src/pages/WorkbookPage/WorkbookPage.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useRef } from \"react\";\nimport { requestGetWorkbookList } from \"../../api\";\nimport WorkbookItem from \"../../components/workbook/WorkbookItem/WorkbookItem\";\nimport { Column, Container, Table, Tbody, Thead } from \"./WorkbookPage.styles\";\nimport SearchContainer from \"../../components/workbook/SearchContainer/SearchContainer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction WorkbookPage() {\n  _s();\n\n  const [keyword, setKeyword] = useState(null);\n  const [lastWorkbookId, setLastWorkbookId] = useState(null);\n  const [workbookList, setWorkbookList] = useState([]);\n  const obsRef = useRef(null);\n  const cursor = useRef(null); // useRef는 일반적인 자바스크립트 객체입니다 즉 heap 영역에 저장됩니다\n  // 그래서 어플리케이션이 종료되거나 가비지 컬렉팅 될 때 까지 참조할 때 마다 같은 메모리 주소를 가지게 되고\n  // 같은 메모리 주소를 가지기 때문에 === 연산이 항상 true를 반환하고, 값이 바뀌어도 리렌더링 되지 않습니다.\n  //\n  //     하지만 함수 컴포넌트 내부에 변수를 선언한다면, 렌더링 될 때마다 값이 초기화 됩니다.\n  //     그래서 해당 방법을 지양하는 것 같습니다 :)\n\n  const getWorkbookList = async () => {\n    const response = await requestGetWorkbookList({\n      lastWorkbookId,\n      keyword\n    });\n\n    if (response.data.length === 0) {\n      console.log(\"불러올 문제가 존재하지 않습니다.\");\n      return;\n    }\n\n    cursor.current = response.data[response.data.length - 1].id;\n    setWorkbookList(prevState => [...prevState, ...response.data]);\n  };\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(entries => {\n      const target = entries[0];\n\n      if (target.isIntersecting) {\n        setLastWorkbookId(cursor.current);\n      }\n    }, {\n      threshold: 0.5\n    });\n    if (obsRef.current) observer.observe(obsRef.current);\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    getWorkbookList();\n  }, [lastWorkbookId, keyword]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(SearchContainer, {\n      keyword: keyword,\n      setKeyword: setKeyword,\n      setWorkbookList: setWorkbookList,\n      cursor: cursor\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      children: [/*#__PURE__*/_jsxDEV(Thead, {\n        children: [/*#__PURE__*/_jsxDEV(Column, {\n          style: {\n            width: \"12%\"\n          },\n          children: \"\\uAD6C\\uBD84\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Column, {\n          style: {\n            width: \"64%\"\n          },\n          children: \"\\uBB38\\uC81C\\uC9D1 \\uC774\\uB984\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Column, {\n          style: {\n            width: \"14%\"\n          },\n          children: \"\\uC0DD\\uC131\\uC790\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Column, {\n          style: {\n            width: \"14%\"\n          },\n          children: \"\\uC0DD\\uC131\\uC77C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tbody, {\n        children: [workbookList.map(workbook => {\n          return /*#__PURE__*/_jsxDEV(WorkbookItem, {\n            workbook: workbook\n          }, workbook.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 20\n          }, this);\n        }), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: obsRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n}\n\n_s(WorkbookPage, \"Aw3debXdso/xDKku+GApOD9Ohxo=\");\n\n_c = WorkbookPage;\nexport default WorkbookPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"WorkbookPage\");","map":{"version":3,"names":["useEffect","useState","useRef","requestGetWorkbookList","WorkbookItem","Column","Container","Table","Tbody","Thead","SearchContainer","WorkbookPage","keyword","setKeyword","lastWorkbookId","setLastWorkbookId","workbookList","setWorkbookList","obsRef","cursor","getWorkbookList","response","data","length","console","log","current","id","prevState","observer","IntersectionObserver","entries","target","isIntersecting","threshold","observe","disconnect","width","map","workbook"],"sources":["/Users/keunhyung/IdeaProjects/workbooksfrontdev/front/src/pages/WorkbookPage/WorkbookPage.js"],"sourcesContent":["import { useEffect, useState, useRef } from \"react\";\nimport { requestGetWorkbookList } from \"../../api\";\nimport WorkbookItem from \"../../components/workbook/WorkbookItem/WorkbookItem\";\nimport { Column, Container, Table, Tbody, Thead } from \"./WorkbookPage.styles\";\nimport SearchContainer from \"../../components/workbook/SearchContainer/SearchContainer\";\n\nfunction WorkbookPage() {\n  const [keyword, setKeyword] = useState(null);\n  const [lastWorkbookId, setLastWorkbookId] = useState(null);\n  const [workbookList, setWorkbookList] = useState([]);\n  const obsRef = useRef(null);\n  const cursor = useRef(null);\n\n  // useRef는 일반적인 자바스크립트 객체입니다 즉 heap 영역에 저장됩니다\n  // 그래서 어플리케이션이 종료되거나 가비지 컬렉팅 될 때 까지 참조할 때 마다 같은 메모리 주소를 가지게 되고\n  // 같은 메모리 주소를 가지기 때문에 === 연산이 항상 true를 반환하고, 값이 바뀌어도 리렌더링 되지 않습니다.\n  //\n  //     하지만 함수 컴포넌트 내부에 변수를 선언한다면, 렌더링 될 때마다 값이 초기화 됩니다.\n  //     그래서 해당 방법을 지양하는 것 같습니다 :)\n\n  const getWorkbookList = async () => {\n    const response = await requestGetWorkbookList({ lastWorkbookId, keyword });\n    if (response.data.length === 0) {\n      console.log(\"불러올 문제가 존재하지 않습니다.\");\n      return;\n    }\n    cursor.current = response.data[response.data.length - 1].id;\n    setWorkbookList((prevState) => [...prevState, ...response.data]);\n  };\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const target = entries[0];\n        if (target.isIntersecting) {\n          setLastWorkbookId(cursor.current);\n        }\n      },\n      { threshold: 0.5 }\n    );\n    if (obsRef.current) observer.observe(obsRef.current);\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    getWorkbookList();\n  }, [lastWorkbookId, keyword]);\n\n  return (\n    <Container>\n      <SearchContainer\n        keyword={keyword}\n        setKeyword={setKeyword}\n        setWorkbookList={setWorkbookList}\n        cursor={cursor}\n      />\n      <Table>\n        <Thead>\n          <Column style={{ width: \"12%\" }}>구분</Column>\n          <Column style={{ width: \"64%\" }}>문제집 이름</Column>\n          <Column style={{ width: \"14%\" }}>생성자</Column>\n          <Column style={{ width: \"14%\" }}>생성일</Column>\n        </Thead>\n        <Tbody>\n          {workbookList.map((workbook) => {\n            return <WorkbookItem key={workbook.id} workbook={workbook} />;\n          })}\n          <div ref={obsRef} />\n        </Tbody>\n      </Table>\n    </Container>\n  );\n}\nexport default WorkbookPage;\n"],"mappings":";;;AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,MAA9B,QAA4C,OAA5C;AACA,SAASC,sBAAT,QAAuC,WAAvC;AACA,OAAOC,YAAP,MAAyB,qDAAzB;AACA,SAASC,MAAT,EAAiBC,SAAjB,EAA4BC,KAA5B,EAAmCC,KAAnC,EAA0CC,KAA1C,QAAuD,uBAAvD;AACA,OAAOC,eAAP,MAA4B,2DAA5B;;;AAEA,SAASC,YAAT,GAAwB;EAAA;;EACtB,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBZ,QAAQ,CAAC,IAAD,CAAtC;EACA,MAAM,CAACa,cAAD,EAAiBC,iBAAjB,IAAsCd,QAAQ,CAAC,IAAD,CAApD;EACA,MAAM,CAACe,YAAD,EAAeC,eAAf,IAAkChB,QAAQ,CAAC,EAAD,CAAhD;EACA,MAAMiB,MAAM,GAAGhB,MAAM,CAAC,IAAD,CAArB;EACA,MAAMiB,MAAM,GAAGjB,MAAM,CAAC,IAAD,CAArB,CALsB,CAOtB;EACA;EACA;EACA;EACA;EACA;;EAEA,MAAMkB,eAAe,GAAG,YAAY;IAClC,MAAMC,QAAQ,GAAG,MAAMlB,sBAAsB,CAAC;MAAEW,cAAF;MAAkBF;IAAlB,CAAD,CAA7C;;IACA,IAAIS,QAAQ,CAACC,IAAT,CAAcC,MAAd,KAAyB,CAA7B,EAAgC;MAC9BC,OAAO,CAACC,GAAR,CAAY,oBAAZ;MACA;IACD;;IACDN,MAAM,CAACO,OAAP,GAAiBL,QAAQ,CAACC,IAAT,CAAcD,QAAQ,CAACC,IAAT,CAAcC,MAAd,GAAuB,CAArC,EAAwCI,EAAzD;IACAV,eAAe,CAAEW,SAAD,IAAe,CAAC,GAAGA,SAAJ,EAAe,GAAGP,QAAQ,CAACC,IAA3B,CAAhB,CAAf;EACD,CARD;;EAUAtB,SAAS,CAAC,MAAM;IACd,MAAM6B,QAAQ,GAAG,IAAIC,oBAAJ,CACdC,OAAD,IAAa;MACX,MAAMC,MAAM,GAAGD,OAAO,CAAC,CAAD,CAAtB;;MACA,IAAIC,MAAM,CAACC,cAAX,EAA2B;QACzBlB,iBAAiB,CAACI,MAAM,CAACO,OAAR,CAAjB;MACD;IACF,CANc,EAOf;MAAEQ,SAAS,EAAE;IAAb,CAPe,CAAjB;IASA,IAAIhB,MAAM,CAACQ,OAAX,EAAoBG,QAAQ,CAACM,OAAT,CAAiBjB,MAAM,CAACQ,OAAxB;IACpB,OAAO,MAAM;MACXG,QAAQ,CAACO,UAAT;IACD,CAFD;EAGD,CAdQ,EAcN,EAdM,CAAT;EAgBApC,SAAS,CAAC,MAAM;IACdoB,eAAe;EAChB,CAFQ,EAEN,CAACN,cAAD,EAAiBF,OAAjB,CAFM,CAAT;EAIA,oBACE,QAAC,SAAD;IAAA,wBACE,QAAC,eAAD;MACE,OAAO,EAAEA,OADX;MAEE,UAAU,EAAEC,UAFd;MAGE,eAAe,EAAEI,eAHnB;MAIE,MAAM,EAAEE;IAJV;MAAA;MAAA;MAAA;IAAA,QADF,eAOE,QAAC,KAAD;MAAA,wBACE,QAAC,KAAD;QAAA,wBACE,QAAC,MAAD;UAAQ,KAAK,EAAE;YAAEkB,KAAK,EAAE;UAAT,CAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QADF,eAEE,QAAC,MAAD;UAAQ,KAAK,EAAE;YAAEA,KAAK,EAAE;UAAT,CAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAFF,eAGE,QAAC,MAAD;UAAQ,KAAK,EAAE;YAAEA,KAAK,EAAE;UAAT,CAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAHF,eAIE,QAAC,MAAD;UAAQ,KAAK,EAAE;YAAEA,KAAK,EAAE;UAAT,CAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAJF;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,eAOE,QAAC,KAAD;QAAA,WACGrB,YAAY,CAACsB,GAAb,CAAkBC,QAAD,IAAc;UAC9B,oBAAO,QAAC,YAAD;YAAgC,QAAQ,EAAEA;UAA1C,GAAmBA,QAAQ,CAACZ,EAA5B;YAAA;YAAA;YAAA;UAAA,QAAP;QACD,CAFA,CADH,eAIE;UAAK,GAAG,EAAET;QAAV;UAAA;UAAA;UAAA;QAAA,QAJF;MAAA;QAAA;QAAA;QAAA;MAAA,QAPF;IAAA;MAAA;MAAA;MAAA;IAAA,QAPF;EAAA;IAAA;IAAA;IAAA;EAAA,QADF;AAwBD;;GApEQP,Y;;KAAAA,Y;AAqET,eAAeA,YAAf"},"metadata":{},"sourceType":"module"}